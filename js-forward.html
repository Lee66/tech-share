<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>前传：源起、战争史歌七部曲</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/wx.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">
		<style media="screen">
			ul,small{
				width: 100%;
			}
		</style>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<!-- 章节 -->
				<section>
					<h1>纪元</h1>
					<p>
						<ul>
							<li>前 言 <span class="fragment highlight-red">星球崛起</span> Browser</li>
							<li>第一纪 <span class="fragment highlight-green">上古时期</span>  Module?</li>
							<li>第二纪<span class="fragment highlight-green">石器时代</span> Script Loader</li>
							<li>第三纪 <span class="fragment highlight-green">蒸汽朋克</span> Module Loader</li>
							<li>第四纪<span class="fragment highlight-red">号角吹响</span>  CommonJS</li>
							<li>第五纪 <span class="fragment highlight-blue">双塔奇兵</span> AMD/CMD</li>
							<li>第六纪 <span class="fragment highlight-blue">精灵宝钻</span> Browserify/Webpack</li>
							<li>第七纪 <span class="fragment highlight-blue">王者归来</span> ES6 Module</li>
						</ul>
					</p>
				</section>
				<!-- 前言 星球崛起 -->
				<section data-markdown>
				    <script type="text/template">
							### 前言 星球崛起

							# *盘古开天地*

							从大神说起

							<small>在很久很久以前......</small><!-- .element: class="fragment"-->
				    </script>
				</section>
				<!-- 	Tim Berners-Lee -->
				<section data-markdown>
<script type="text/template">
<img src="img/lee.jpg" style="
    width: 300px;
    border-radius: 0;
"/>
## Tim Berners-Lee<!-- .element: class="fragment"-->
</script>
        </section>
				<!-- 开元年  -->
				<section data-markdown>
<script type="text/template">
### 开元年表
- 1989年：初步构想
- 1990年：Nexus(WorldWideWeb)诞生
- 1991年：史上第一个网站( http://info.cern.ch )上线
- 1992年：放弃销售浏览器软件，继续坚守技术指引者角色
- 1994年：万维网联盟(w3c)创建
- 2009年：万维网基金会(w3f)创建
</script>
				</section>
				<section data-markdown>
<script type="text/template">
### 浏览器
<img src="img/browser-history.jpg" style="
    width: 460px;
    border-radius: 0;
"/>

<small>从 userAgent 看浏览器的发展史</small><!-- .element: class="fragment"-->
</script>
				</section>
        <section data-markdown>
<script type="text/template">
### 唐尧虞舜

# *Mosaic*
<small style="color:#1b91ff">大神就是大神，起名都不一般，我叫马赛克</small><!-- .element: class="fragment"-->

- Nexus不支持显示图片<!-- .element: class="fragment"-->
<small style="color:#1b91ff">无图无真相，导火索点燃</small><!-- .element: class="fragment"-->
- NCSA_Mosaic/2.0 (Windows 3.1)<!-- .element: class="fragment"-->
<small style="color:#1b91ff">为了识别Nexus、Mosic(注：NCSA是马赛克所在的组织名)</small><!-- .element: class="fragment"-->
</script>
        </section>
				<section data-markdown>
<script type="text/template">
### 楚汉争霸

# *Mozilla*
<small style="color:#1b91ff">避免法律纠纷，后又改名为Netscape Navigator(网景)</small><!-- .element: class="fragment"-->

- 哥斯拉(Godzilla)谐音<!-- .element: class="fragment"-->
<small style="color:#1b91ff">诚然是一头野心勃勃的怪兽</small><!-- .element: class="fragment"-->
- ”Mosaic Killa”之意<!-- .element: class="fragment"-->
<small style="color:#1b91ff">Killa是俚语中Killer的拼法，即“马赛克的终结者”，赤裸裸的挑战</small><!-- .element: class="fragment"-->
- userAgent为Mozilla/1.0 (Win3.1)<!-- .element: class="fragment"-->
<small style="color:#1b91ff">改名不改性</small><!-- .element: class="fragment"-->
</script>
				</section>
				<section data-markdown>
<script type="text/template">
### 宋元之战

# *IE*
<small style="color:#1b91ff">命名直接，用途拍脸上，还要什么说明书</small><!-- .element: class="fragment"-->
- Mozilla/1.22 (compatible; MSIE 2.0; Windows 95)<!-- .element: class="fragment"-->
<small style="color:#1b91ff">区区userAgent......</small><!-- .element: class="fragment"-->
</script>
				</section>
				<section data-markdown>
<script type="text/template">
### 康乾盛世

# *Firefox*
<small style="color:#1b91ff">苦逼的命名经过：Phoenix(凤凰)、Firebird(火鸟)，全TM被告了</small><!-- .element: class="fragment"-->
- Mozilla/5.0 (Windows; U; Windows NT 5.1; sv-SE; rv:1.7.5) Gecko/20041108 Firefox/1.0<!-- .element: class="fragment"-->
<small style="color:#1b91ff">Gecko(壁虎)是一个浏览器排版引擎，NetScape的大神们围绕Geoko成立了非正式组织Mozilla</small><!-- .element: class="fragment"-->
</script>
				</section>
				<section data-markdown>
<script type="text/template">
### 师夷长技

# *Konqueror*
<small style="color:#1b91ff">Conqueror的变体，意为征服者(前有航海家网景、探索者IE)</small><!-- .element: class="fragment"-->
-  KDE推出，主要用在linux上
- Mozilla/5.0 (compatible; Konqueror/3.2; FreeBSD) (KHTML, like Gecko)<!-- .element: class="fragment"-->
<small style="color:#1b91ff">KHTML跟Gecko一样，都是排版引擎，但用户只买Gecko的账，于是萌萌哒的like出来了</small><!-- .element: class="fragment"-->
</script>
				</section>
				<section>
	<section data-markdown>
<script type="text/template">
### 世界大战

<img src="img/world-war.jpg" alt="" style="width:800px;">
</script>
	</section>
	<section data-markdown>
<script type="text/template">
	Opera:

- Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 9.51
- Mozilla/5.0 (Windows NT 6.0; U; en; rv:1.8.1) Gecko/20061208 Firefox/2.0.0 Opera 9.51
- Opera/9.51 (Windows NT 5.1; U; en)
<small style="color:#1ab11d">狂暴模式，我有炫酷的易容术</small>

<section data-markdown>
<script type="text/template">
	Safari:
- Mozilla/5.0 (Macintosh; U; PPC Mac OS X; de-de) AppleWebKit/85.7 (KHTML, like Gecko)
<small style="color:#1ab11d">Webkit的排版引擎叫WebCore，是KHTML衍生而来的，所以(KHTML, like Gecko)也继承过来了</small><!-- .element: class="fragment"-->
	</script>
	</section>

	<section data-markdown>
	<script type="text/template">
	Chrome:
- Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.2.149.27 Safari/525.13
<small style="color:#1ab11d">包含Safari，你懂的</small>
	</script>
	</section>
	
	<section data-markdown>
	<script type="text/template">
		## 战争格局
		Chrome->Safari->WebKit->KHTML->Gecko->Mozilla
	</script>
	</section>
				</section>
				<section>
<section data-markdown>
<script type="text/template">
	### 国内军阀

	# *大乱斗*

- 360，百度，QQ，UC，搜狗，猎豹，遨游，世界之窗，淘宝，酷狗，hao123...<!-- .element: class="fragment"-->
- 完美兼容、急速浏览、智能双核，读书人的微创新<!-- .element: class="fragment"-->
- 3Q大战<!-- .element: class="fragment"-->
</script>
</section>
<section data-markdown>
<script type="text/template">
- QQ
<small>
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.7.26717.400)
</small>

- 猎豹
<small>
Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36 LBBROWSER
</small>
</script>
</section>
</section>
<section data-markdown>
<script type="text/template">
	### 未来
- userAgent标准：https://www.w3.org/TR/UAAG/
- 星球崛起终<!-- .element: class="fragment" -->
</script>
</section>
				<!-- 第一纪 上古时期 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第一纪 上古时期

                        # *Module?*

                        从设计模式说起
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        最早，我们这么写代码

                        ```javascript
                        function foo(){
                            //...
                        }
                        function bar(){
                            //...
                        }
                        ```

                        Global 被污染，很容易命名冲突
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        简单封装：*Namespace* 模式

                        ```javascript
                        var MYAPP = {
                            foo: function(){},
                            bar: function(){}
                        }

                        MYAPP.foo();
                        ```

                        - 减少 Global 上的变量数目
                        <!-- .element: class="fragment" -->

                        - 本质是对象，一点都不安全
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        匿名闭包 ：*IIFE* 模式

                        ```javascript
                        var Module = (function(){
                            var _private = "safe now";
                            var foo = function(){
                                console.log(_private)
                            }

                            return {
                                foo: foo
                            }
                        })()

                        Module.foo();
                        Module._private; // undefined
                        ```

                        函数是 JavaScript 唯一的 Local Scope
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        再增强一点 ：引入依赖

                        ```javascript
                        var Module = (function($){
                            var _$body = $("body");     // we can use jQuery now!
                            var foo = function(){
                                console.log(_$body);    // 特权方法
                            }

                            // Revelation Pattern
                            return {
                                foo: foo
                            }
                        })(jQuery)

                        Module.foo();

                        ```

                        <p class="fragment">
                            这就是<em><b>模块模式</b></em><br>
                            也是现代模块实现的基石
                        </p>
                    </script>
                </section>
				<!-- 第二纪 石器时代 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第二纪 石器时代

                        # *Script Loader*

                        只有封装性可不够，我们还需要加载
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## Let's back to script tags

                        ```
                        body
                            script(src="jquery.js")
                            script(src="app.js")    // do some $ things...
                        ```

                        Order is essential
                        <!-- .element: class="fragment" -->

                        Load in parallel
                        <!-- .element: class="fragment" -->

                        DOM 顺序即执行顺序
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        但现实是这样的…

                        ```
                        body
                            script(src="zepto.js")
                            script(src="jhash.js")
                            script(src="fastClick.js")
                            script(src="iScroll.js")
                            script(src="underscore.js")
                            script(src="handlebar.js")
                            script(src="datacenter.js")
                            script(src="deferred.js")
                            script(src="util/wxbridge.js")
                            script(src="util/login.js")
                            script(src="util/base.js")
                            script(src="util/city.js")
                            script(src="util/date.js")
                            script(src="util/cookie.js")
                            script(src="app.js")
                        ```
                    </script>
                </section>

                <section data-markdown data-background="attach/bm_1.jpg"
                    style="background:rgba(0,0,0,0.8)"
                >
                    <script type="text/template">
                        - 难以维护 *Very difficult to maintain!*

                        - 依赖模糊 *Unclear Dependencies*

                        - 请求过多 *Too much HTTP calls*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [LABjs](http://labjs.com/) - script loader

                        (2009)

                        Loading And Blocking JavaScript


                        > *Using LABjs will replace all that ugly <br >"script tag soup"*


                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        How Does It Works?

                        ```
                        script(src="LAB.js" async)
                        ```

                        ```javascript
                        $LAB.script("framework.js").wait()
                            .script("plugin.framework.js")
                            .script("myplugin.framework.js").wait()
                            .script("init.js");
                        ```
                        <blockquote class="fragment"><p>Executed in parallel? </p></blockquote>

                        *First-come, First-served <br> (when execution order is not important)*
                        <!-- .element: class="fragment" -->

                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        #### Sugar

                        ```javascript
                        $LAB
                        .script( [ "script1.js", "script2.js", "script3.js"] )
                        .wait(function(){ // wait for all scripts to execute first
                            script1Func();
                            script2Func();
                            script3Func();
                        });
                        ```
                        *Dependency Management<br>基于文件的依赖管理*
                        <!-- .element: class="fragment" -->

                    </script>
                </section>
				<!-- 第三纪 蒸汽朋克 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第三纪 蒸汽朋克

                        # *Module Loader*

                        模块化架构的工业革命
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [YUI3](yuilibrary.com) Loader - Module Loader
                        (2009)

                        <img src="attach/yui-logo.png" class="logo" style="max-width:150px" />

                        > *YUI's lightweight core and <br>**modular architecture**<br> make it scalable, fast, and robust.*

                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        回顾昔日王者的风采:

                        ```javascript
                        // YUI - 编写模块
                        YUI.add('dom', function(Y) {
                          Y.DOM = { ... }
                        })

                        // YUI - 使用模块
                        YUI().use('dom', function(Y) {
                          Y.DOM.doSomeThing();
                          // use some methods DOM attach to Y
                        })
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Creating Custom Modules

                        ```javascript
                        // hello.js
                        YUI.add('hello', function(Y){
                            Y.sayHello = function(msg){
                                Y.DOM.set(el, 'innerHTML', 'Hello!');
                            }
                        },'3.0.0',{
                            requires:['dom']
                        })
                        ```
                        ```
                        // main.js
                        YUI().use('hello', function(Y){
                            Y.sayHello("hey yui loader");
                        })
                        ```

                        *基于模块的依赖管理*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Let's Go A Little Deeper

                        ```javascript
                        // Sandbox Implementation
                        function Sandbox() {
                            // ...
                            // initialize the required modules
                            for (i = 0; i < modules.length; i += 1) {
                                Sandbox.modules[modules[i]](this);
                            }
                            // ...
                        }
                        ```

                        Y 其实是一个强沙箱
                        <!-- .element: class="fragment" -->

                        所有依赖模块通过 attach 的方式被注入沙盒
                        <!-- .element: class="fragment" -->

                        *attach：在当前 YUI 实例上执行模块的初始化代码，使得模块在当前实例上可用*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Still "Script Tag Soup"?

                        ```javascript
                        script(src="/path/to/yui-min.js")       // YUI seed
                        script(src="/path/to/my/module1.js")    // add('module1')
                        script(src="/path/to/my/module2.js")    // add('module2')
                        script(src="/path/to/my/module3.js")    // add('module3')
                        ```
                        ```
                        YUI().use('module1', 'module2', 'module3', function(Y) {
                            // you can use all this module now
                        });
                        ```

                        <em>
                            <ul class="fragment">
                                <li>you don't have to include script tags in a set order</li>
                                <li>separation of loading from execution</li>
                            </ul>
                        </em>
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        漏了一个问题？ *Too much HTTP calls*
                        <!-- .element: class="fragment" -->

                        ## YUI Combo
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        How Combo Works

                        ```
                        script(src="http://yui.yahooapis.com/3.0.0/build/yui/yui-min.js")
                        script(src="http://yui.yahooapis.com/3.0.0/build/dom/dom-min.js")
                        ```

                        ↓ <small style="margin:14px"> magic combo </small>

                        ```
                        script(src="http://yui.yahooapis.com/combo?
                            3.0.0/build/yui/yui-min.js&
                            3.0.0/build/dom/dom-min.js")
                        ```
                        <!-- .element: class="fragment" -->

                        *Serves multiple files in a single request*
                        <!-- .element: class="fragment" -->

                        GET 请求，需要服务器支持
                        <!-- .element: class="fragment" -->

                        [alibaba/nginx-http-concat](https://github.com/alibaba/nginx-http-concat)
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template" >
                        <img src="attach/joke/3.jpg" height="300px" width="300px" />

                        - 合并 *Concat*

                        - 压缩 *Minify*

                        - 混淆 *Uglify*

                    </script>
                </section>
				<!-- 第四话 号角吹响 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第四纪 号角吹响

                        # *CommonJS*

                        征服世界的第一步是跳出浏览器
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [CommonJS](http://www.commonjs.org/) - API Standard

                        (2009.08)

                        <img src="attach/commonjs-logo.png" class="logo" style="max-width:200px" />

                        > *javascript:<br> not just for browsers any more!*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        # [Modules/1.0](http://wiki.commonjs.org/wiki/Modules/1.0)
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        模块的定义与引用

                        ```javascript
                        // math.js
                        exports.add = function(a, b){
                            return a + b;
                        }
                        ```
                        ```javascript
                        // main.js
                        var math = require('math')      // ./math in node
                        console.log(math.add(1, 2));    // 3
                        ```

                        *Magic Free Variable*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        [NodeJS](http://nodejs.org) : Simple HTTP Server

                        ```javascript
                        // server.js
                        var http = require("http"),
                            PORT = 8000;

                        http.createServer(function(req, res){
                            res.end("Hello World");
                        }).listen(PORT);

                        console.log("listenning to " + PORT);
                        ```
                        ```
                        $ node server.js
                        ```
                        <!-- .element: class="fragment" -->

                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        #### Synchronously

                        ```javascript
                        // timeout.js
                        var EXE_TIME = 2;

                        (function(second){
                            var start = +new Date();
                            while(start + second*1000 > new Date()){}
                        })(EXE_TIME)

                        console.log("2000ms executed")
                        ```
                        ```
                        // main.js
                        require('./timeout');   // sync load
                        console.log('done!');
                        ```

                        *同步/阻塞式加载*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        同步加载对服务器/本地环境并不是问题

                        <br>

                         硬盘 I/O | | 网速 I/O
                        -----|------- | ------|-------
                        HDD: | *100 MB/s*  | ADSL: | *4 Mb/s*
                        SSD: | *600 MB/s*  | 4G: | *100 Mb/s*
                        SATA-III:| *6000 Mb/s*  | Fiber: | *100 Mb/s*

                        <br>

                        ### *浏览器环境才是问题！*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>
				<!-- 第五话 双塔奇兵 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第五纪 双塔奇兵

                        # *AMD/CMD*

                        浏览器环境模块化方案
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        分歧和冲突

                        ## *[Modules/Async](http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition)*
                        ## *[Modules/Wrappings](http://wiki.commonjs.org/wiki/Modules/Wrappings)*

                        <div class="fragment">

                        <h3>*Modules/Transport*</h3>
                        <h4>*<del>Modules/2.0</del>*</h4>

                        </div>

                        <small style="margin-top:15px">
                            [《前端模块化开发的那点历史 - 玉伯》](https://github.com/seajs/seajs/issues/588)
                        </small>
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## *[AMD(Async Module Definition)](http://wiki.commonjs.org/wiki/Modules/AsynchronousDefinition)*

                        RequireJS 对模块定义的规范化产出

                        <br>

                        ## *[CMD(Common Module Definition)](https://github.com/cmdjs/specification/blob/master/draft/module.md)*

                        SeaJS 对模块定义的规范化产出
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [RequireJS](http://requirejs.org/) - AMD Implementation

                        (2011)

                        <img src="attach/requirejs-logo.svg"
                            class="logo"
                            style="max-width:130px; margin:0px" />

                        > *JavaScript file and module loader.<br> It is optimized for in-browser use*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        If `require()` is async?

                        ```
                        //CommonJS Syntax
                        var Employee = require("types/Employee");

                        function Programmer (){
                            //do something
                        }

                        Programmer.prototype = new Employee();

                        //如果 require call 是异步的，那么肯定 error
                        //因为在执行这句前 Employee 模块根本来不及加载进来
                        ```

                        *this code will not work*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *Function Wrapping*

                        ```
                        //AMD Wrapper
                        define(
                            ["types/Employee"],  //依赖
                            function(Employee){  //这个回调会在所有依赖都被加载后才执行
                                function Programmer(){
                                    //do something
                                };

                                Programmer.prototype = new Employee();
                                return Programmer;  //return Constructor
                            }
                        )

                        ```
                        looks familiar?
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *Sugar - simplified CommonJS wrapping*

                        ```javascript
                        define(function (require) {
                            var dependency1 = require('dependency1'),
                                dependency2 = require('dependency2');

                            return function () {};
                        });
                        ```
                        ```javascript
                        // parse out require...
                        define(
                            ['require', 'dependency1', 'dependency2'],
                        function (require) {
                            var dependency1 = require('dependency1'),
                                dependency2 = require('dependency2');

                            return function () {};
                        });
                        ```
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *AMD vs CommonJS*

                        ### 书写风格

                        ```javascript
                        // Module/1.0
                        var a = require("./a");  // 依赖就近
                        a.doSomething();

                        var b = require("./b")
                        b.doSomething();
                        ```

                        ```javascript
                        // AMD recommended style
                        define(["a", "b"], function(a, b){ // 依赖前置
                            a.doSomething();
                            b.doSomething();
                        })
                        ```

                        *Both OK*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *AMD vs CommonJS*

                        ### 执行时机

                        ```
                        // Module/1.0
                        var a = require("./a");  // 执行到此时，a.js 同步下载并执行
                        ```

                        ```
                        // AMD with CommonJS sugar
                        define(["require"], function(require){
                            // 在这里， a.js 已经下载并且执行好了
                            var a = require("./a")
                        })

                        ```

                        *Early Download, Early Executing*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [SeaJS](http://seajs.org/docs/) - CMD Implementation

                        (2011)

                        <img src="attach/seajs-logo.png" class="logo" />

                        > *Extremely simple experience of modular development*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *More like CommonJS Style*

                        ```javascript
                        define(function(require, exports) {
                            var a = require('./a');
                            a.doSomething();

                            exports.foo = 'bar';
                            exports.doSomething = function() {};
                        });
                        ```
                        ```javascript
                        // RequireJS 兼容风格
                        define('hello', ['jquery'], function(require, exports, module) {
                            return {
                                foo: 'bar',
                                doSomething: function() {}
                            };
                        });
                        ```
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *AMD vs CMD - the truly different*

                        ### Still Execution Time

                        ```
                        // AMD recommended
                        define(['a', 'b'], function(a, b){
                            a.doSomething();    // 依赖前置，提前执行
                            b.doSomething();
                        })
                        ```
                        ```
                        // CMD recommanded
                        define(function(require, exports, module){
                            var a = require("a");
                            a.doSomething();
                            var b = require("b");
                            b.doSomething();    // 依赖就近，延迟执行
                        })

                        ```

                        *Early Download, Lazy Executing*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *RequireJS 最佳实践*
                        <small style="
                            vertical-align: baseline;
                            margin-left: 10px;
                        ">
                            <a href="#/47">跳过</a>
                        </small>

                        ### Use Case

                        ```javascript
                        require([
                            'React',    // 尽量使用 ModuleID
                            'IScroll',
                            'FastClick'
                            'navBar',   // 和同目录下的 js 文件
                            'tabBar',
                        ], function(
                            React,      // Export
                            IScroll
                            FastClick
                            NavBar,
                            TabBar,
                        ) {
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *RequireJS 最佳实践*

                        ### Config

                        ```javascript
                        require.config({
                            // 查找根路径，当加载包含协议或以/开头、.js结尾的文件时不启用
                            baseUrl: "./js",
                            // 配置 ModuleID 与 路径 的映射
                            paths: {
                                React: "lib/react-with-addons",
                                FastClick: "http://cdn.bootcss.com/fastclick/1.0.3/fastclick.min",
                                IScroll: "lib/iscroll",
                            },
                            // 为那些“全局变量注入”型脚本做依赖和导出配置
                            shim: {
                                'IScroll': {
                                    exports: "IScroll"
                                },
                            },
                            // 从 CommonJS 包中加载模块
                            packages: [
                                {
                                    name: "ReactChart",
                                    location: "lib/react-chart",
                                    main: "index"
                                }
                            ]
                        })
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *RequireJS 最佳实践*

                        ### Optimized Build

                        ```bash
                        node r.js -o build.js
                        ```
                        ```javascript
                        // build.js
                        // 简单的说，要把所有配置 repeat 一遍
                        ({
                            appDir: './src',
                            baseUrl: './js',
                            dir: './dist',
                            modules: [
                                {
                                    name: 'app'
                                }
                            ],
                            fileExclusionRegExp: /^(r|build)\.js$/,
                            optimizeCss: 'standard',
                            removeCombined: true,
                            paths: {
                                React : "lib/react-with-addons",
                                FastClick: "http://cdn.bootcss.com/fastclick/1.0.3/fastclick.min",
                                IScroll: "lib/iscroll"
                            },
                            shim: {
                                'IScroll': {
                                    exports: "IScroll"
                                },
                            },
                            packages: [
                                {
                                    name: "ReactChart",
                                    location: "lib/react-chart",
                                    main: "index"
                                }
                            ]
                        })
                        ```
                    </script>
                </section>
				<!-- 第六话 精灵宝钻 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第六纪 精灵宝钻

                        # *Browserify/Webpack*

                        大势所趋，去掉这层包裹！
                    </script>
                </section>

                <section data-markdown data-background="attach/npm.png"
                    style="background: rgba(0,0,0,0.7)"
                >
                    <script type="text/template">
                        # *[NPM](https://www.npmjs.com/)*
                        Node Package Manger

                        *Browsers don't have the require method defined, <br>but Node.js does.*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [Browserify](http://browserify.org/) - CommonJS in browser

                        (2011 / 2014 stable)

                        <img src="attach/browserify-logo.png" class="logo" style="width:320px;margin-bottom:-40px" />

                        > *require('modules') in the browser by bundling up all of your dependencies*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Install

                        ```
                        $ npm install -g browserify
                        ```
                        ### *Actually you need do nothing but write CommonJS code!*
                        <!-- .element: class="fragment" -->

                        ```
                        # magic just happened!
                        $ browserify main.js -o bundle.js
                        ```
                        <!-- .element: class="fragment" -->

                        #### *Demo Time*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        A Little Low-Level

                        *Browserify parses the AST for require() calls to traverse the entire dependency graph of your project.*

                        ### [AST: Abstract Syntax Tree](https://en.wikipedia.org/wiki/Abstract_syntax_tree)
                        <!-- .element: class="fragment" -->

                        <img src="attach/ast.png" class="logo fragment" style="width:320px;" />
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        每一次改动都需要手动 recompile ？

                        No, auto-recompile.

                        ## *Watch - [Watchify](https://www.npmjs.com/package/watchify)*
                        <!-- .element: class="fragment" -->

                        ```
                        $ npm install -g watchify
                        ```
                        <!-- .element: class="fragment" -->

                        ```
                        # WATCH!
                        $ watchify app.js -o bundle.js -v
                        ```
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Build 后要如何 Debug

                        ## *Source Map*
                        <!-- .element: class="fragment" -->

                        ```bash
                        # debug mode
                        $ browserify main.js -o bundle.js --debug
                        ```
                        <!-- .element: class="fragment" -->

                        *逆向所有合并、压缩、混淆！*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## *`npm run`*

                        ```
                        $ npm run [command] [-- <args>]
                        ```
                        <!-- .element: class="fragment" -->

                        ```javascript
                        // package.json
                        {
                            //....
                            "scripts": {
                                "build": "browserify app.js -o bundle.js",
                                "watch": "watchify app.js -o bundle.js -v"
                            }
                        }
                        ```
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [Webpack](http://webpack.github.io/) - Module Bundler

                        (2014)

                        <img src="attach/webpack-icon.png" class="logo" style="width:320px;margin-bottom:-60px" />

                        > *transforming, bundling, or packaging just about any resource or asset*
                    </script>
                </section>



                <section data-markdown>
                    <script type="text/template">
                        Webpack For Browserify Users

                        ```bash
                        # These are equivalent:
                        $ browserify main.js > bundle.js
                        $ webpack main.js bundle.js
                        ```

                        *BUT*
                        ```javascript
                        // better with a webpack.config.js
                        module.exports = {
                            entry: "./main.js",
                            output: {
                                filename: "bundle.js"
                            }
                        }
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *Simple [CLI](http://webpack.github.io/docs/cli.html)*

                        ```bash
                        # make sure your directory contains webpack.config.js

                        # Development: debug + devtool + source-map + pathinfo
                        webpack main.js bundle.js -d

                        # Production: minimize + occurence-order
                        webpack main.js bundle.js -p

                        # Watch Mode
                        webpack main.js bundle.js --watch
                        ```

                        Everything is already there!
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        *Browserify vs Webpack*

                        ## 小而美 VS 大而全

                        <br>

                        - [Browserify VS Webpack - JS Drama](http://blog.namangoel.com/browserify-vs-webpack-js-drama)
                        - [Comparison - Webpack](http://webpack.github.io/docs/comparison.html)
                        - [Webpack for browserify users](http://webpack.github.io/docs/webpack-for-browserify-users.html)
                        - [Browserify for webpack users](https://gist.github.com/substack/68f8d502be42d5cd4942)

                    </script>
                </section>

                <style>
                    .bloom{
                        transform: scale(0);
                        transition: transform 0.7s cubic-bezier(0.68, 0.04, 0.49, 0.95);
                    }
                    .present .bloom{
                        transform: scale(1);
                    }
                </style>
                <section data-markdown>
                    <script type="text/template">
                        <div class="bloom">
                            Is webpack just the other Browserify?
                            <div>
                                <h1>Webpack - *Like a pro* </h1>
                                <p>webpack *特别增强篇*</p>
                            </div>
                            <img src="attach/webpack-icon.png" class="logo" width="220" />
                        </div>
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [Motivation](http://webpack.github.io/docs/motivation.html)

                        - Compatibility (CommonJS, AMD, ES6...)

                        - Code Splitting

                        - Loaders & Plugins

                        - Development Tools & Workflow
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *[Using Loaders](http://webpack.github.io/docs/using-loaders.html)*

                        ```javascript
                        // webpack.config.js
                        module.exports = {
                            entry: './main.js',
                            output: {
                                filename: 'bundle.js'
                            }{,
                            module: {
                                loaders: [{
                                    test: /\.js$/,
                                    loader: 'babel-loader'
                                }]
                            }}
                        }
                        ```

                        ***JSX Demo***
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## *[Why only JavaScript?](http://webpack.github.io/docs/motivation.html#why-only-javascript)*

                        > There are many other *static resources* that need to be handled
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *require()* static resources!

                        ```javascript
                        // Ensure the stylesheet is loaded
                        require('./bootstrap.css');

                        // get a URL or DataURI
                        var myImage = document.createElement('img');
                        myImage.src = require('./myImage.jpg');
                        ```

                        <blockquote class="fragment">
                            <p>They are part of *dependency graph*</p>
                        </blockquote>

                        *包含静态资源的依赖管理*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *require()* anything!

                        ```javascript
                        // CSS Preprocesser
                        require('./style.less');
                        require('./anotherStyle.scss');

                        // Compile-to-JS Language
                        var myModule = require('./myModule.coffee');
                        var myTypedModule = require('./myTypedModule.ts');
                        ```

                        Universal Module System
                        <!-- .element: class="fragment" -->

                        *对所有模块一视同仁的的依赖管理*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *Sass & Images*

                        ```javascript
                        var webpackConfig = {
                            module: {
                                loaders: [{
                                    test: /\.scss$/,
                                    loaders: 'style!css!sass'
                                }, {
                                    test: /\.(png|jpg|svg)$/,
                                    loader: 'url?limit=20480' //20k
                                }]
                            }}
                        }
                        ```

                        * Deal with CSS problems
                        <!-- .element: class="fragment" -->

                        * Inlining your images to DataURI
                        <!-- .element: class="fragment" -->

                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *[Using Plugins](http://webpack.github.io/docs/using-plugins.html)*

                        ```javascript
                        var config = {
                            entry: ['webpack/hot/dev-server', './app/main.js'],
                            module: {
                                loaders: [{
                                    test: /\.(js|jsx)$/,
                                    loaders: ['react-hot', 'babel']
                                }]
                            },
                            plugins: [
                                //Enables Hot Modules Replacement
                                new webpack.HotModuleReplacementPlugin(),
                            ],
                        };
                        ```

                        #### [React Hot Loader!](http://gaearon.github.io/react-hot-loader/)
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *[Code Splitting](http://webpack.github.io/docs/code-splitting.html)*

                        > split your codebase into “chunks” which are loaded on demand.

                        - [Optimizing Common Code](https://github.com/petehunt/webpack-howto#8-optimizing-common-code)
                        <!-- .element: class="fragment" -->

                        - [Async Loading ](https://github.com/petehunt/webpack-howto#9-async-loading)
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        More Resources

                        ## [Webpack Howto (Pete Hunt)](https://github.com/petehunt/webpack-howto)
                        ## [React Webpack Cookbook](http://christianalfoni.github.io/react-webpack-cookbook/index.html)


                    </script>
                </section>
				<!-- 第七话 王者归来 -->
				<section data-markdown>
                    <script type="text/template">
                        ### 第七纪 王者归来

                        # *ES6 Module*

                        最后的战役
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### There is no module in JavaScript!

                        <p class="fragment"> (Until *ECMAScript 6*) </p>
                        <!-- .element: class="fragment" -->

                        ### Well...But there is no runtime...
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ## [Babel](https://babeljs.io/) - JavaScript Compiler

                        (2015)

                        <img src="attach/babel-logo.png" class="logo" style="width:300px;margin:0;margin-bottom:-50px" />

                        > *Use next generation JavaScript, today.*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        Let's get into it!!

                        ### *Single Default Module*

                        ```dart
                        // math.js
                        export default math = {
                            PI: 3.14,
                            foo: function(){}
                        }
                        ```

                        ```dart
                        // app.js
                        import math from "./math";
                        math.PI
                        ```

                        ```
                        # babel magic!
                        $ babel-node app.js
                        ```
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *With ES6 Destructuring*

                        ```dart
                        // components.js
                        import Button from './Button';
                        import Header from './Header';

                        // use property value shorthand
                        export {
                            Button,
                            Header
                        }
                        ```
                        ```dart
                        // app.js
                        import { Button, Header } from "./components";
                        ```

                        *Sooooo Awesome!*
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *Export Members*

                        ```dart
                        // export Declaration
                        export function foo(){
                            console.log('I am not bar.');
                        }
                        ```
                        ```dart
                        // export VariableStatement;
                        export var PI = 3.14;
                        export var bar = foo;   // function expression
                        ```
                        ```dart
                        // export { ExportsList }
                        var PI = 3.14;
                        var foo = function(){};

                        export { PI, foo };
                        ```
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *Import Members*

                        ```dart
                        // import { ImportsList } from "module-name"
                        import { PI } from "./math";
                        import { PI, foo } from "module-name";
                        ```

                        ```dart
                        // import IdentifierName as ImportedBinding
                        import { foo as bar } from "./math";
                        bar();  // use alias bar
                        ```

                        ```dart
                        // import NameSpaceImport
                        import * as math from "./math";
                        math.PI
                        math.foo()
                        ```

                        *[Airbnb JavaScript Style Guide - Modules](https://github.com/airbnb/javascript#modules)*
                        <!-- .element: class="fragment" -->
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        ### *For more detail...*

                        ## [ECMA-262/6.0/#Exports](http://www.ecma-international.org/ecma-262/6.0/#sec-exports)
                        ## [ECMA-262/6.0/#Imports](http://www.ecma-international.org/ecma-262/6.0/#sec-imports)

                        <span style="font-size:55px">“ </span>
                        <small style="vertical-align:text-top"> 习惯了就会觉得很好用的 (´Д` ) ”</small>
                        <span style="padding-left:22px"></span>
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        <div style="
                            position: relative;
                            margin-left: -300px;">
                            <img src="attach/babel-logo.png" class="logo" style="width:300px;margin:0;margin-bottom:-35px" />
                            <h1>*×*</h1>
                            <h2 style="
                                position: absolute;
                                right: 150px;
                                top:134px;
                                font-style: italic;
                            ">[= babelify](https://github.com/babel/babelify)</h2>
                            <img src="attach/browserify-logo.png" class="logo" style="width:400px;margin-top:-70px" />
                        </div>
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        <div style="
                            position: relative;
                            margin-left: -300px;">
                            <img src="attach/babel-logo.png" class="logo" style="width:300px;margin:0;margin-bottom:-35px" />
                            <h1>*×*</h1>
                            <h2 style="
                                position: absolute;
                                right: 100px;
                                top:134px;
                                font-style: italic;
                            ">[= babel-loader](https://github.com/babel/babel-loader)</h2>
                            <img src="attach/webpack-icon.png" class="logo" style="width:380px;margin-top:-30px" />
                        </div>
                    </script>
                </section>

                <section data-markdown>
                    <script type="text/template">
                        # *Question*

                        Hey, don't be shy.
                    </script>
                </section>
								<section style="text-align: left;">
									<h1>THE END</h1>
									<p>
										参考链接太多，待列举
									</p>
								</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
